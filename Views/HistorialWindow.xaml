<Window x:Class="FlujoCajaWpf.Views.HistorialWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ðŸ“Š Historial del Sistema" 
        Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="{DynamicResource BackgroundBrush}">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Padding="20">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#1E3A8A" Offset="0"/>
                    <GradientStop Color="#3B82F6" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Border.Effect>
                <DropShadowEffect ShadowDepth="2" BlurRadius="8" Opacity="0.3"/>
            </Border.Effect>

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Logo y tÃ­tulo -->
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Viewbox Width="50" Height="50" Margin="0,0,15,0">
                        <TextBlock Text="ðŸ“Š" FontSize="40"/>
                    </Viewbox>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="Historial del Sistema" 
                                   FontSize="20" 
                                   FontWeight="Bold" 
                                   Foreground="White"/>
                        <TextBlock Text="Registro de todas las acciones realizadas" 
                                   FontSize="12" 
                                   Foreground="#93C5FD"/>
                    </StackPanel>
                </StackPanel>

                <!-- BotÃ³n Cerrar -->
                <Button Grid.Column="2" 
                        Content="âœ• Cerrar" 
                        VerticalAlignment="Center"
                        Padding="20,10"
                        Background="#3B82F6"
                        Foreground="White"
                        BorderThickness="0"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Cursor="Hand"
                        Click="BtnCerrar_Click">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                CornerRadius="6"
                                                Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#2563EB"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>
        </Border>

        <!-- Contenido Principal -->
        <Grid Grid.Row="1">
            <!-- TabControl con mÃ³dulos -->
            <TabControl Name="tabControl" Margin="20" BorderThickness="0">
                <TabControl.Resources>
                    <Style TargetType="TabItem">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="TabItem">
                                    <Border Name="Border" 
                                            Background="{DynamicResource CardBackgroundBrush}" 
                                            BorderBrush="#E5E7EB" 
                                            BorderThickness="1,1,1,0"
                                            CornerRadius="8,8,0,0"
                                            Padding="20,12"
                                            Margin="0,0,5,0">
                                        <ContentPresenter ContentSource="Header" 
                                                          HorizontalAlignment="Center" 
                                                          VerticalAlignment="Center"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="Border" Property="Background" Value="#EFF6FF"/>
                                            <Setter TargetName="Border" Property="BorderBrush" Value="#3B82F6"/>
                                            <Setter TargetName="Border" Property="BorderThickness" Value="1,2,1,0"/>
                                        </Trigger>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="Border" Property="Background" Value="#F3F4F6"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Setter Property="FontSize" Value="14"/>
                        <Setter Property="FontWeight" Value="SemiBold"/>
                        <Setter Property="Foreground" Value="#374151"/>
                    </Style>
                </TabControl.Resources>

                <!-- Tab Casas -->
                <TabItem Header="ðŸ  Casas">
                    <Grid Background="{DynamicResource CardBackgroundBrush}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Filtros -->
                        <Border Grid.Row="0" Background="{DynamicResource BackgroundBrush}" BorderBrush="#E5E7EB" BorderThickness="0,0,0,1" Padding="20">
                            <StackPanel>
                                <TextBlock Text="Filtros" FontSize="14" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,10"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                        <TextBlock Text="Usuario" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,5"/>
                                        <ComboBox Name="cmbUsuarioCasas" Height="36" FontSize="13"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                        <TextBlock Text="AcciÃ³n" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,5"/>
                                        <ComboBox Name="cmbAccionCasas" Height="36" FontSize="13" SelectionChanged="FiltrosCasas_Changed">
                                            <ComboBoxItem Content="Todas" IsSelected="True" Tag=""/>
                                            <ComboBoxItem Content="âž• Crear" Tag="crear"/>
                                            <ComboBoxItem Content="âœï¸ Editar" Tag="editar"/>
                                            <ComboBoxItem Content="âŒ Eliminar" Tag="eliminar"/>
                                            <ComboBoxItem Content="ðŸŸ¢ Activar" Tag="activar"/>
                                            <ComboBoxItem Content="ðŸ”´ Desactivar" Tag="desactivar"/>
                                        </ComboBox>
                                    </StackPanel>

                                    <StackPanel Grid.Column="2" Margin="0,0,10,0">
                                        <TextBlock Text="Buscar" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,5"/>
                                        <TextBox Name="txtBuscarCasas" Height="36" FontSize="13" Padding="10,8" TextChanged="FiltrosCasas_Changed"/>
                                    </StackPanel>

                                    <Button Grid.Column="3" Content="ðŸ” Buscar" 
                                            VerticalAlignment="Bottom"
                                            Padding="20,8"
                                            Background="#3B82F6"
                                            Foreground="White"
                                            BorderThickness="0"
                                            FontSize="13"
                                            Cursor="Hand"
                                            Click="BtnBuscarCasas_Click"/>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- DataGrid -->
                        <DataGrid Name="dgCasas" 
                                  Grid.Row="1"
                                  AutoGenerateColumns="False"
                                  IsReadOnly="True"
                                  SelectionMode="Single"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  HeadersVisibility="Column"
                                  GridLinesVisibility="Horizontal"
                                  RowHeight="50"
                                  Background="{DynamicResource CardBackgroundBrush}"
                                  BorderThickness="0"
                                  FontSize="13">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Fecha" Binding="{Binding FechaTexto}" Width="140"/>
                                <DataGridTextColumn Header="Usuario" Binding="{Binding UsuarioEmail}" Width="200"/>
                                <DataGridTextColumn Header="Casa" Binding="{Binding EntidadNombre}" Width="180"/>
                                <DataGridTextColumn Header="AcciÃ³n" Binding="{Binding AccionTexto}" Width="120"/>
                                <DataGridTextColumn Header="DescripciÃ³n" Binding="{Binding Descripcion}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>

                        <!-- PaginaciÃ³n -->
                        <Border Grid.Row="2" Background="{DynamicResource BackgroundBrush}" BorderBrush="#E5E7EB" BorderThickness="0,1,0,0" Padding="20,15">
                            <Grid>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Name="txtInfoCasas" Text="Mostrando 1-50 de 150 registros" 
                                               VerticalAlignment="Center" FontSize="13" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button Name="btnAnteriorCasas" Content="â—€ Anterior" 
                                            Padding="15,8" Margin="0,0,10,0"
                                            Background="{DynamicResource CardBackgroundBrush}" BorderBrush="#D1D5DB" BorderThickness="1"
                                            FontSize="13" Cursor="Hand" Click="BtnAnteriorCasas_Click"/>
                                    
                                    <TextBlock Name="txtPaginaCasas" Text="PÃ¡gina 1 de 3" 
                                               VerticalAlignment="Center" Margin="10,0"
                                               FontSize="13" FontWeight="SemiBold"/>
                                    
                                    <Button Name="btnSiguienteCasas" Content="Siguiente â–¶" 
                                            Padding="15,8" Margin="10,0,0,0"
                                            Background="{DynamicResource CardBackgroundBrush}" BorderBrush="#D1D5DB" BorderThickness="1"
                                            FontSize="13" Cursor="Hand" Click="BtnSiguienteCasas_Click"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </Grid>
                </TabItem>

                <!-- Tab Movimientos -->
                <TabItem Header="ðŸ’° Movimientos">
                    <Grid Background="{DynamicResource CardBackgroundBrush}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Filtros Movimientos -->
                        <Border Grid.Row="0" Background="{DynamicResource BackgroundBrush}" BorderBrush="#E5E7EB" BorderThickness="0,0,0,1" Padding="20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                    <TextBlock Text="Usuario" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,5"/>
                                    <ComboBox Name="cmbUsuarioMovimientos" Height="36" FontSize="13"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Margin="0,0,10,0">
                                    <TextBlock Text="AcciÃ³n" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,5"/>
                                    <ComboBox Name="cmbAccionMovimientos" Height="36" FontSize="13" SelectionChanged="FiltrosMovimientos_Changed">
                                        <ComboBoxItem Content="Todas" IsSelected="True" Tag=""/>
                                        <ComboBoxItem Content="âž• Crear" Tag="crear"/>
                                        <ComboBoxItem Content="âœï¸ Editar" Tag="editar"/>
                                        <ComboBoxItem Content="âŒ Eliminar" Tag="eliminar"/>
                                    </ComboBox>
                                </StackPanel>

                                <StackPanel Grid.Column="2" Margin="0,0,10,0">
                                    <TextBlock Text="Buscar" FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,5"/>
                                    <TextBox Name="txtBuscarMovimientos" Height="36" FontSize="13" Padding="10,8" TextChanged="FiltrosMovimientos_Changed"/>
                                </StackPanel>

                                <Button Grid.Column="3" Content="ðŸ” Buscar" 
                                        VerticalAlignment="Bottom"
                                        Padding="20,8"
                                        Background="#3B82F6"
                                        Foreground="White"
                                        BorderThickness="0"
                                        FontSize="13"
                                        Cursor="Hand"
                                        Click="BtnBuscarMovimientos_Click"/>
                            </Grid>
                        </Border>

                        <!-- DataGrid Movimientos -->
                        <DataGrid Name="dgMovimientos" 
                                  Grid.Row="1"
                                  AutoGenerateColumns="False"
                                  IsReadOnly="True"
                                  SelectionMode="Single"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  HeadersVisibility="Column"
                                  GridLinesVisibility="Horizontal"
                                  RowHeight="50"
                                  Background="{DynamicResource CardBackgroundBrush}"
                                  BorderThickness="0"
                                  FontSize="13">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Fecha" Binding="{Binding FechaTexto}" Width="140"/>
                                <DataGridTextColumn Header="Usuario" Binding="{Binding UsuarioEmail}" Width="180"/>
                                <DataGridTextColumn Header="Casa" Binding="{Binding EntidadNombre}" Width="160"/>
                                <DataGridTextColumn Header="AcciÃ³n" Binding="{Binding AccionTexto}" Width="100"/>
                                <DataGridTextColumn Header="DescripciÃ³n" Binding="{Binding Descripcion}" Width="*"/>
                                <DataGridTemplateColumn Header="Deshacer" Width="80">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button Content="â†¶" 
                                                    ToolTip="Deshacer movimiento"
                                                    Width="32" Height="32"
                                                    Background="#EF4444"
                                                    Foreground="White"
                                                    BorderThickness="0"
                                                    FontSize="18"
                                                    FontWeight="Bold"
                                                    Cursor="Hand"
                                                    Click="BtnDeshacer_Click"
                                                    Tag="{Binding Id}"
                                                    Visibility="{Binding PuedeDeshacer, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                <Button.Style>
                                                    <Style TargetType="Button">
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="Button">
                                                                    <Border Background="{TemplateBinding Background}"
                                                                            CornerRadius="4">
                                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                    </Border>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                        <Style.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#DC2626"/>
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>

                        <!-- PaginaciÃ³n Movimientos -->
                        <Border Grid.Row="2" Background="{DynamicResource BackgroundBrush}" BorderBrush="#E5E7EB" BorderThickness="0,1,0,0" Padding="20,15">
                            <Grid>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <TextBlock Name="txtInfoMovimientos" Text="Mostrando registros" 
                                               VerticalAlignment="Center" FontSize="13" Foreground="{DynamicResource TextSecondaryBrush}"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button Name="btnAnteriorMovimientos" Content="â—€ Anterior" 
                                            Padding="15,8" Margin="0,0,10,0"
                                            Background="{DynamicResource CardBackgroundBrush}" BorderBrush="#D1D5DB" BorderThickness="1"
                                            FontSize="13" Cursor="Hand" Click="BtnAnteriorMovimientos_Click"/>
                                    
                                    <TextBlock Name="txtPaginaMovimientos" Text="PÃ¡gina" 
                                               VerticalAlignment="Center" Margin="10,0"
                                               FontSize="13" FontWeight="SemiBold"/>
                                    
                                    <Button Name="btnSiguienteMovimientos" Content="Siguiente â–¶" 
                                            Padding="15,8" Margin="10,0,0,0"
                                            Background="{DynamicResource CardBackgroundBrush}" BorderBrush="#D1D5DB" BorderThickness="1"
                                            FontSize="13" Cursor="Hand" Click="BtnSiguienteMovimientos_Click"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </Grid>
                </TabItem>

                <!-- Tab DueÃ±os -->
                <TabItem Header="ðŸ‘¤ DueÃ±os">
                    <Grid Background="{DynamicResource CardBackgroundBrush}">
                        <TextBlock Text="PrÃ³ximamente: Historial de DueÃ±os" 
                                   HorizontalAlignment="Center" 
                                   VerticalAlignment="Center"
                                   FontSize="16" 
                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                    </Grid>
                </TabItem>

                <!-- Tab CategorÃ­as -->
                <TabItem Header="ðŸ“ CategorÃ­as">
                    <Grid Background="{DynamicResource CardBackgroundBrush}">
                        <TextBlock Text="PrÃ³ximamente: Historial de CategorÃ­as" 
                                   HorizontalAlignment="Center" 
                                   VerticalAlignment="Center"
                                   FontSize="16" 
                                   Foreground="{DynamicResource TextSecondaryBrush}"/>
                    </Grid>
                </TabItem>
            </TabControl>
        </Grid>
    </Grid>
</Window>
